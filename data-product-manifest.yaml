jobId: "2486"
jobName: col-lineage-adp
jobType: Aggregated Data Product
developerId: b8f49c1f-f967-420f-8709-ea864dc0caa5
domain: business
alias: load_all_into_adp
discoveryPort:
  name: col-lineage-adp
inputPorts:
  - alias: data2_sadp_1
    isDynamic: true
    dataProductUrn: urn:dv:dataproduct:6187c8c3-739b-4305-9a30-44d3775881c9
    filter: ""
    projection: ""
    optional:
      persistDataFrame: false
    type: dataproduct
  - alias: city_info_1
    isDynamic: true
    connection: Postgres
    tableName/query: city_info
    optional:
      persistDataFrame: false
      enableDataReconciliation: false
      enforceSchema: false
      dataSetUrn: urn:dv:dataset:f5853bd6-a108-46cd-a01f-61ccaf39f536
    type: readPostGreSqlDbUsingJdbc
productState:
  isDynamic: true
  alias: load_all_into_adp
  retentionVersions: ""
  logicalSchema:
    properties:
      Name:
        type: STRING
        description: Name of the user
        sourceColumn: Name
        sourceTable: public.data_1
      Age:
        type: STRING
        description: Age of the user
        sourceColumn: Age
        sourceTable: public.data_1
      City:
        type: STRING
        description: Location of the user
        sourceColumn: City
        sourceTable: public.data_1
      Occupation:
        type: STRING
        description: Profession of the user
        sourceColumn: Occupation
        sourceTable: public.data_1
  stateStoreType: writeDataFrameToPostgresTable
  isProfilingEnabled: false
  updateStrategy: Overwrite
  connection: Postgres
  tableName: public.col_lineage_adp
  optional:
    persistDataFrame: true
    enableDataReconciliation: false
    enforceSchema: true
  refreshInterval: None
transformation:
  - isDynamic: true
    alias: Spark_SQL_1
    description: select all from col-lineage-sadp
    sequence: 3
    inputDataFrameList:
      - inputDataFrame: data2_sadp_1
        tempViewName: d
      - inputDataFrame: city_info_1
        tempViewName: c
    query: SELECT d.name,d.age,d.city,c.country,c.region,CASE WHEN d.age < 30 THEN
      'Young' WHEN d.age BETWEEN 30 AND 50 THEN 'Mid' ELSE 'Senior' END AS
      age_group,CASE WHEN d.age >= 60 THEN true ELSE false END AS
      is_senior,UPPER(d.occupation) AS occupation_normalized FROM d JOIN c ON
      d.city = c.city;
    optional:
      persistDataFrame: true
    type: operationThroughSqlQuery
controlPort:
  dataQualityRules: {}
